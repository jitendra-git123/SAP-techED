node(){

def check
  stage('prepare') {
   //   check=checkout scm
   //   echo "${check}"
   //     echo ">>>>>>>${check.GIT_COMMIT}"
  }

stage ("build") {
                step([$class: 'UCDeployPublisher', 
                                                component: [
                                                                componentName: 'ABAP',
                                                                componentTag: '',
                                                                delivery: [
                                                                                $class: 'Push',
                                                                                baseDir: "/var/lib/jenkins/workspace/Ericsson/Ericsson_Build_UCD",
                                                                                fileExcludePatterns: '',
                                                                                fileIncludePatterns: '**/*',
                                                                                pushDescription: '',
                                                                                pushIncremental: false,
                                                                                pushVersion: "${BUILD_NUMBER}"]
                                                ]])
                                                
                                newComponentVersionId = "${ABAP_VersionId}"
                                echo "Component Version ID =>>>>>>>${newComponentVersionId}"
        step([$class: 'UploadBuild',
           tenantId: "5ade13625558f2c6688d15ce",
           revision: "${newComponentVersionId}",
           appName: "SAP_ABAP-BE",
           requestor: "admin",
           id: "${majorVersion}",
           versionName: "${BUILD_NUMBER}"
        ])
   }


stage('Publish to UrbanCode Deploy') {        
                sleep 15
                                step([$class: 'UCDeployPublisher', 
                                                deploy: [
                                                                createSnapshot: [
                                                                                deployWithSnapshot: true,
                                                                                snapshotName: "${BUILD_NUMBER}"],
                                                                                deployApp: 'SAP_ABAP-BE',
                                                                                deployDesc: 'Requested from Jenkins',
                                                                                deployEnv: 'DEV',
                                                                                deployOnlyChanged: false,
                                                                                deployProc: 'deploy',
                                                                                deployReqProps: '',
                                                                                deployVersions: "ABAP:${BUILD_NUMBER}"]])
 }
 
 
                }
